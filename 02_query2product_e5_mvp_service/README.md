# üîé –ü–æ–∏—Å–∫ –ø–æ —Ç–æ–≤–∞—Ä–∞–º –Ω–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞—Ö E5

## –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç ‚Äî —Å–µ—Ä–≤–∏—Å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ —Ç–æ–≤–∞—Ä–∞–º —Å –ø–æ–º–æ—â—å—é —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π (E5). 
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å, –∞ —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ –±–æ–ª—å—à–æ–π –±–∞–∑—ã, –∏—Å–ø–æ–ª—å–∑—É—è –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏.

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∞—Ç–∞—Å–µ—Ç [tasksource/esci](https://huggingface.co/datasets/tasksource/esci) (–∑–∞–ø—Ä–æ—Å—ã, —Ç–æ–≤–∞—Ä—ã, –º–µ—Ç–∫–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏).
- –ú–æ–¥–µ–ª—å –¥–æ–æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –∑–∞–¥–∞—á–µ –ø–æ–∏—Å–∫–∞ (Triplet Loss).
- –î–ª—è –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Å—á–∏—Ç–∞—é—Ç—Å—è —ç–º–±–µ–¥–¥–∏–Ω–≥–∏.
- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ Streamlit.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ app.py                    # Streamlit –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞
‚îú‚îÄ‚îÄ EDA_plus_baseline.ipynb   # EDA –∏ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ train_e5.ipynb            # –û–±—É—á–µ–Ω–∏–µ –∏ –¥–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ E5
‚îú‚îÄ‚îÄ calc_all_embed.ipynb      # –†–∞—Å—á–µ—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤
‚îú‚îÄ‚îÄ product_titles.csv        # –ù–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤
‚îú‚îÄ‚îÄ product_embeddings.npy    # –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ —Ç–æ–≤–∞—Ä–æ–≤ (–±–æ–ª—å—à–æ–π —Ñ–∞–π–ª)
‚îú‚îÄ‚îÄ product_stats.csv         # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤
‚îú‚îÄ‚îÄ saved_e5_model/           # –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ checkpoints/              # –ß–µ–∫–ø–æ–∏–Ω—Ç—ã –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ runs/                     # –õ–æ–≥–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ logs/                     # –õ–æ–≥–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è TensorBoard)
‚îú‚îÄ‚îÄ images/                   # –ö–∞—Ä—Ç–∏–Ω–∫–∏ –¥–ª—è README (—Å–æ–∑–¥–∞—Ç—å –≤—Ä—É—á–Ω—É—é)
‚îî‚îÄ‚îÄ README.md                 # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
# –∏–ª–∏ –≤—Ä—É—á–Ω—É—é:
pip install streamlit torch transformers pandas numpy matplotlib seaborn tqdm datasets
```

### 2. EDA –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

- –û—Ç–∫—Ä–æ–π `EDA_plus_baseline.ipynb` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø–µ—Ä–≤–∏—á–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö.
- –ò—Å–ø–æ–ª—å–∑—É–π Jupyter –∏–ª–∏ VSCode.

### 3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

- –ó–∞–ø—É—Å—Ç–∏ `train_e5.ipynb` –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ E5 –Ω–∞ —Å–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
- –ß–µ–∫–ø–æ–∏–Ω—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫—É `checkpoints/`.

### 4. –†–∞—Å—á–µ—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤

- –ó–∞–ø—É—Å—Ç–∏ `calc_all_embed.ipynb` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤.
- –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `product_embeddings.npy`.

### 5. –ó–∞–ø—É—Å–∫ –≤–µ–±-—Å–µ—Ä–≤–∏—Å–∞ –ø–æ–∏—Å–∫–∞

```bash
streamlit run app.py
```
- –û—Ç–∫—Ä–æ–µ—Ç—Å—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Ç–æ–≤–∞—Ä–∞–º.

---

## –í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### TensorBoard (–µ—Å–ª–∏ –µ—Å—Ç—å –ª–æ–≥–∏ –æ–±—É—á–µ–Ω–∏—è)

```bash
tensorboard --logdir=logs/ --port=6006
```
- –û—Ç–∫—Ä–æ–µ—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:6006

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GPU

```bash
nvitop
# –∏–ª–∏
watch -n 1 nvidia-smi
```

---

## –†–∞–±–æ—Ç–∞ —Å —Ñ–æ–Ω–æ–≤—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ —á–µ—Ä–µ–∑ tmux

–î–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ (Streamlit, TensorBoard, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Ç.–¥.) –≤ —Ñ–æ–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [tmux](https://github.com/tmux/tmux):

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é tmux —Å –∏–º–µ–Ω–µ–º mysession
tmux new -s mysession

# –í–Ω—É—Ç—Ä–∏ tmux –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ª—é–±—ã–µ –∫–æ–º–∞–Ω–¥—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä:
streamlit run app.py
tensorboard --logdir=logs/ --port=6006
nvitop

# –ß—Ç–æ–±—ã –æ—Ç—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –æ—Ç —Å–µ—Å—Å–∏–∏ (–æ—Å—Ç–∞–≤–∏–≤ –ø—Ä–æ—Ü–µ—Å—Å—ã —Ä–∞–±–æ—Ç–∞—Ç—å):
Ctrl+b, –∑–∞—Ç–µ–º d

# –ß—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–µ—Å—Å–∏–∏:
tmux attach -t mysession

# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–µ—Å—Å–∏–π:
tmux ls

# –ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ—Å—Å–∏—é:
exit
```

---

## –ö–∞–∫ –ø—Ä–∏–ª–æ–∂–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫–∏

1. –°–æ–∑–¥–∞–π –ø–∞–ø–∫—É `images/` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞.
2. –°–æ—Ö—Ä–∞–Ω–∏ —Ç—É–¥–∞ –≥—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è, –ø—Ä–∏–º–µ—Ä—ã –≤—ã–¥–∞—á–∏, —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ —Ç.–¥.
3. –í—Å—Ç–∞–≤–ª—è–π –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ README —Ç–∞–∫:

```markdown
![–ì—Ä–∞—Ñ–∏–∫ –æ–±—É—á–µ–Ω–∏—è](images/train_loss.png)
![–ü—Ä–∏–º–µ—Ä –≤—ã–¥–∞—á–∏](images/search_example.png)
```

---

## .gitignore

–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –±–æ–ª—å—à–∏–µ –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
```
product_embeddings.npy
small_product_embeddings.npy
product_stats.csv
product_titles.csv
runs/
saved_e5_model/
checkpoints/
logs/
```

---

## –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–ª–∏—á–∏–µ GPU (CUDA) –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞.
- –î–ª—è –∑–∞–ø—É—Å–∫–∞ Streamlit –∏ EDA –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ CPU.

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞
–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã ‚Äî –ø–∏—à–∏!
